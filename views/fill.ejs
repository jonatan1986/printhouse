<!DOCTYPE html>
<html>
  <head>
    <div id="designpagetitle">
      <h2  dir="rtl"><%= title %></h2>
    </div>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <style>
    body{  height: 1400px;}
    .photo h3{
      position: relative;
      right:240px;
      font:bold 20px "macabi";
    }
    h4{
      position: relative;
      right:240px;
      top:240px;
      font:bold 20px "macabi";
    }
    .photo img{
      position: absolute;
      top:130px;
      right:300px;
      max-height: 200px;
      max-width: 200px;
      object-fit: cover;
    }
    #font{
      position: absolute;
      right:295px;
      top:390px;
    }
    #title{
      position: absolute;
      right:295px;
      top:430px;
    }

    #content{
      position: absolute;
      right:295px;
      top:480px;
    }
    .showresult{
      position: absolute;
      right:295px;
      top:700px;
    }
    #errorDisplay{
      position: absolute;
      right:295px;
      top:730px;
    }
    /* #result{
      position: absolute;
      right:295px;
      top:770px;
    } */
    .result img{
      position: absolute;
      right:295px;
      /* top:700px;
      max-height: 10px;
      max-width: 10px; */
      top:800px;
      max-height: 600px;
      max-width: 600px;
      object-fit: cover;
    }
    .resultTitle {
      position: absolute;
      right:500px;
      top:880px;
      object-fit: cover;
    }
    .resultContent {
      position: absolute;
      right:400px;
      top:930px;
      object-fit: cover;
    }

    </style>
  </head>
  <body onload="initOnLoad()">
    <% if (!locals.user) { %>
      <script>
        window.location.href = "/login";
      </script>
    <% } %>
    <% include topmenu %>
    <% include menu %>
    <div class="photo">
      <h3 dir="rtl" >זו התמונה שבחרת:</h3>
      <img id ="photo" src ='' />
    </div>
    <div>
      <!-- <label for="cars">אנא בחר גופן:</label> -->
        <h4 dir="rtl" >אנא בחר גופן: </h4>
        <select dir="rtl" id="font" onchange="SetFont()" >
          <option value="macabi" >macabi</option>
          <option value="anka" >anka </option>
          <option value="carmelit">carmelit</option>
          <option value="gan" >gan</option>
          <option value="open-sans" >open-sans</option>
          <option value="trashim">trashim</option>
        </select>
        <form method='post' enctype='multipart/form-data'>
          <p dir="rtl" ><input  id="title" type='text' name='title[name]' oninput="SetTitle(this.value)" placeholder='כותרת'/></p>
          <textarea  id="content" dir="rtl"  rows="10" cols="50" name='content[name]' oninput="SetContent(this.value)" placeholder='תוכן'></textarea>
          <!-- <p><input type='submit' class="showresult"  value='שמור שינויים'/></p> -->
          <!-- <p><input type='file', name='photo[image]'/></p>
          <p><input type='submit', value='Upload'/></p> -->
        </form>
        <p id="errorDisplay"></p>
        <p><input type='submit' class="showresult" onclick="displayResult()" value='הצג תוצאה'/></p>
    </div>
    <div class="result">
      <img class="result" src ='' />
      <p class="resultTitle" style="" ></p>
      <p class="resultContent" style=""  ></p>
    </div>

    <script>
    function initOnLoad()
    {
      var filename = localStorage.getItem('filename');
      var path = '/postcards/';
      var totalpath = path.concat(filename);
      document.getElementById('photo').src = totalpath;
      localStorage.setItem("totalpath",totalpath);
      var x = document.getElementById("font").value;
      document.getElementById("title").value = "";
      document.getElementById("content").value = "";
      localStorage.setItem("title","");
      localStorage.setItem("content","");
      SetFont();
    }

    function SetTitle(title)
    {
      localStorage.setItem("title",title);
    }

    function SetContent(content)
    {
      localStorage.setItem("content",content);
    }

    function displayResult()
    {
        if (localStorage.getItem("title").length == 0 || localStorage.getItem("content").length == 0)
        {
          document.getElementById("errorDisplay").innerHTML = "לא מילאת את כל השדות הרלוונטיים";
        }
        else
        {
          document.getElementById("errorDisplay").innerHTML ="";
          var totalpath = localStorage.getItem("totalpath");
          document.getElementsByClassName('result')[1].src = totalpath;
          document.getElementsByClassName('resultTitle')[0].innerHTML = localStorage.getItem("title");
          document.getElementsByClassName('resultContent')[0].innerHTML = localStorage.getItem("content");
        }
    }
    function SetFont()
    {
        SetTitleFont();
        SetContentFont();
    }
    function SetTitleFont()
    {
       var style = "";
       style = style.concat(" 40px ");
       var font =  document.getElementById("font").value;
       style = style.concat(font);
       console.log(style);
       document.getElementsByClassName('resultTitle')[0].style.font = style;
       console.log(document.getElementsByClassName('resultTitle')[0].style.font);
    }
    function SetContentFont()
    {
      var style = "";
      style = style.concat(" 20px ");
      var font =  document.getElementById("font").value;
      style = style.concat(font);
      document.getElementsByClassName('resultContent')[0].style.font = style;
      console.log(document.getElementsByClassName('resultContent')[0].style.font);
    }
    </script>
  </body>
  </html>
